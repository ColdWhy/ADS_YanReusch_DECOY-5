<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DECOY-5</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    #gmail-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 10px 16px;
      background: #d93025;
      border: 1px solid #b1271f;
      color: #f0f0f0;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      display: none;
      box-shadow: 0 2px 6px rgba(0,0,0,0.35);
      transition: all 0.25s ease;
      z-index: 999;
    }

    #gmail-btn:hover {
      background: #b1271f;
      border-color: #8f1f18;
      transform: scale(1.05);
    }

    #gmail-popup {
      position: fixed;
      bottom: 70px;
      right: 20px;
      width: 320px;
      padding: 15px;
      background: rgba(25, 25, 25, 0.95);
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      border: 1px solid rgba(255, 255, 255, 0.08);
      display: none;
      z-index: 999;
    } {
      position: fixed;
      bottom: 70px;
      right: 20px;
      width: 300px;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      display: none;
    }
    #gmail-popup textarea {
      width: 100%;
      height: 120px;
      box-sizing: border-box;
      display: block;
    }
    #gmail-popup input {
      width: 100%;
      margin-bottom: 10px;
      box-sizing: border-box;
      display: block;
    }
  </style>
</head>
<body>
  <div class="overlay"></div>
  <div class="box-container">
    <h1>DECOY-5</h1>

    <div class="form-section">
      <label for="key">Key:</label>
      <input type="text" id="key" placeholder="Enter encryption key" />

      <label for="alphabet">Alphabet:</label>
      <input type="text" id="alphabet" value="ABCDEFGHIJKLMNOPQRSTUVWXYZ,.? " />
      <h5>(Warning: Increasing the number of characters in the alphabet will increase encryption time.)</h5>

      <div class="radio-group">
        <p>Use stored table?</p>
        <label><input type="radio" id="yes" name="choice" value="yes" /> Yes</label>
        <label><input type="radio" id="no" name="choice" value="no" /> No</label>
        <h5>(Warning: Use same password and alphabet if reusing table.)</h5>
      </div>

      <div class="radio-group">
        <p>Save created table?</p>
        <label><input type="radio" id="save_yes" name="save_choice" value="yes" /> Yes</label>
        <label><input type="radio" id="save_no" name="save_choice" value="no" /> No</label>
        <h5>(Warning: Overrides previously stored table.)</h5>
      </div>
    </div>

    <div class="tab-container">
      <div class="tab-header">
        <button class="tab-button active" data-tab="encrypt-tab">Encryption</button>
        <button class="tab-button" data-tab="decrypt-tab">Decryption</button>
      </div>

      <div class="tab-content">
        <div id="encrypt-tab" class="tab active">
          <label for="plaintext">PLAINTEXT:</label>
          <textarea id="plaintext"></textarea>
          <button onclick="server_encrypt()">Encrypt</button>
          <p id="encrypted_text"></p>
        </div>

        <div id="decrypt-tab" class="tab">
          <label for="ciphertext">CIPHERTEXT:</label>
          <textarea id="ciphertext"></textarea>
          <button onclick="server_decrypt()">Decrypt</button>
          <p id="decrypted_text"></p>
        </div>
      </div>
    </div>
  </div>

  <button id="gmail-btn">Gmail</button>

  <div id="gmail-popup">
    <input type="text" id="gmail-to" placeholder="Recipient Email" />
    <textarea id="gmail-body"></textarea>
    <button onclick="sendViaGmail()">Send</button>
  </div>

  <script>
    const tabButtons = document.querySelectorAll(".tab-button");
    const tabs = document.querySelectorAll(".tab");
    const gmailBtn = document.getElementById("gmail-btn");
    const gmailPopup = document.getElementById("gmail-popup");

    tabButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        tabButtons.forEach((b) => b.classList.remove("active"));
        tabs.forEach((t) => t.classList.remove("active"));
        btn.classList.add("active");
        document.getElementById(btn.dataset.tab).classList.add("active");
      });
    });

    function checkForOutput() {
      const enc = document.getElementById("encrypted_text").innerText.trim();
      const dec = document.getElementById("decrypted_text").innerText.trim();
      if (enc || dec) {
        gmailBtn.style.display = "block";
      }
    }

    const observer = new MutationObserver(checkForOutput);
    observer.observe(document.getElementById("encrypted_text"), { childList: true, subtree: true, characterData: true });
    observer.observe(document.getElementById("decrypted_text"), { childList: true, subtree: true, characterData: true });(document.getElementById("encrypted_text"), { childList: true });
    observer.observe(document.getElementById("decrypted_text"), { childList: true });

    gmailBtn.addEventListener("click", () => {
      const enc = document.getElementById("encrypted_text").innerText.trim();
      const dec = document.getElementById("decrypted_text").innerText.trim();
      document.getElementById("gmail-body").value = enc || dec;
      gmailPopup.style.display = gmailPopup.style.display === "block" ? "none" : "block";
    });

    function sendViaGmail() {
      const to = document.getElementById("gmail-to").value;
      const body = encodeURIComponent(document.getElementById("gmail-body").value);
      const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=${to}&su=Encrypted%20Message&body=${body}`;
      window.open(gmailUrl, "_blank");
    }
  </script>

  <script src="script.js"></script>
</body>
</html>
